#!/bin/bash

# üö® –ü–û–õ–ù–ê–Ø –ü–ï–†–ï–°–ë–û–†–ö–ê FRONTEND
echo "üö® –ü–û–õ–ù–ê–Ø –ü–ï–†–ï–°–ë–û–†–ö–ê FRONTEND"
echo "============================"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–∞–ø–∫—É
cd /opt/sofiya

# 1. –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú FRONTEND
echo "1Ô∏è‚É£ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º frontend..."
pm2 stop frontend

# 2. –ü–ï–†–ï–•–û–î–ò–ú –í FRONTEND –ü–ê–ü–ö–£
echo "2Ô∏è‚É£ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ frontend –ø–∞–ø–∫—É..."
cd frontend

# 3. –û–ß–ò–©–ê–ï–ú –í–°–ï –ö–≠–®–ò
echo "3Ô∏è‚É£ –û—á–∏—â–∞–µ–º –≤—Å–µ –∫—ç—à–∏..."
rm -rf .next/
rm -rf node_modules/.cache/
rm -rf .npm/
rm -rf package-lock.json

# 4. –ü–ï–†–ï–£–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ó–ê–í–ò–°–ò–ú–û–°–¢–ò
echo "4Ô∏è‚É£ –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
npm install

# 5. –ü–ï–†–ï–°–û–ë–ò–†–ê–ï–ú FRONTEND
echo "5Ô∏è‚É£ –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º frontend..."
npm run build

# 6. –ü–†–û–í–ï–†–Ø–ï–ú –°–ë–û–†–ö–£
echo "6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–±–æ—Ä–∫—É..."
ls -la .next/

# 7. –ó–ê–ü–£–°–ö–ê–ï–ú FRONTEND
echo "7Ô∏è‚É£ –ó–∞–ø—É—Å–∫–∞–µ–º frontend..."
pm2 start frontend

# 8. –ü–†–û–í–ï–†–Ø–ï–ú –°–¢–ê–¢–£–°
echo "8Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å..."
pm2 status

# 9. –ü–†–û–í–ï–†–Ø–ï–ú –õ–û–ì–ò FRONTEND
echo "9Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ frontend..."
pm2 logs frontend --lines 10

# 10. –¢–ï–°–¢–ò–†–£–ï–ú –°–ê–ô–¢
echo "üîü –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∞–π—Ç..."
curl -I https://mcp-kv.ru

echo ""
echo "üéØ –ü–û–õ–ù–ê–Ø –ü–ï–†–ï–°–ë–û–†–ö–ê FRONTEND –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "‚úÖ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω frontend"
echo "‚úÖ –û—á–∏—â–µ–Ω—ã –≤—Å–µ –∫—ç—à–∏"
echo "‚úÖ –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"
echo "‚úÖ –ü–µ—Ä–µ—Å–æ–±—Ä–∞–Ω frontend"
echo "‚úÖ –ó–∞–ø—É—â–µ–Ω frontend"
echo "‚úÖ –°–∞–π—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç"
echo ""
echo "üîç –¢–µ–ø–µ—Ä—å –∑–∞–π–¥–∏ –Ω–∞ —Å–∞–π—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å!"
